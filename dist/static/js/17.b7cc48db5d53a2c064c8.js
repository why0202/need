webpackJsonp([17],{"8Iv2":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=e("Gu7T"),o=e.n(n),s=e("IhBI"),i=e("rZ/o"),r=e("4AKl"),c=e("FeFv"),m=e("tRgf"),l={components:{Headers:s.a,BScroll:i.a,TopBar:r.a,VTable:c.a},data:function(){return{barData:[],tabsIndex:Number(this.$route.params.type),year:this.$route.params.month.split("-")[0],month:"",tHead:[],tBody:[],tFoot:[],activeArr:[],isLinkNumberMax:1,show:!1,columns:[]}},computed:{_setTitle:function(){return this.tabsIndex?this.$route.params.name+" "+this.month+"月 销售收入考核进度表(万元)":this.$route.params.name+" "+this.month+"月 全量收入考核进度表(万元)"}},mounted:function(){var t=this,a=JSON.parse(localStorage.getItem("yearData"));a.length&&a.forEach(function(a){t.columns.push(a.name),a.name===t.year&&(t.barData=a.children.map(function(a){return a.str===t.$route.params.month.split("-")[1]&&(a.active=!0),a}))})},methods:{onCancel:function(){this.show=!1},onConfirm:function(t){this.year=t,this.onCancel()},_barClick:function(t){t&&(this.month=t.str)},_changeTabs:function(t){this.tabsIndex!==t&&(this.tabsIndex=t,this._getApi())},_getApi:function(){var t=this,a=this,e=a.tabsIndex?"/incomeconstituent/findSalesIncomeConstituent":"/incomeconstituent/findAllIncomeConstituent";a.$post(e,{month:a.year+"-"+a.month,branch:a.$route.params.name}).then(function(e){t.tHead=[e.boxhead].concat(o()(e.incomeItemList)),a.tBody=[];var n=JSON.parse(localStorage.getItem("role"));2===n.role?a.activeArr=[n.gridding]:3===n.role&&(a.activeArr=[n.gridding,n.field]),e.data.forEach(function(t){a.tabsIndex,a.tBody.push({name:t.name,text:[t.name].concat(o()(t.incomeCompleteList.map(function(t){return Object(m.c)(t)})))}),a.tFoot=["合计"].concat(o()(e.statistics.incomeCompleteList.map(function(t){return Object(m.c)(t)})))})})},_trClick:function(t){var a=this.$route.params,e=a.type,n=a.name;this.$router.push("/menu/traction/"+this.year+"-"+this.month+"/"+e+"/"+n+"/grid/"+t.name)}},watch:{month:function(){this._getApi()},year:function(t,a){var e=this;t!==a&&JSON.parse(localStorage.getItem("yearData")).forEach(function(a){a.name===t&&(e.year=a.name,e.barData=a.children)})}}},u={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"grid-wrap common-width"},[e("headers",{attrs:{showRight:""}}),t._v(" "),e("div",{staticClass:"top-date-wrap"},[e("div",{staticClass:"year-wrap",on:{click:function(a){t.show=!0}}},[t._v(t._s(t.year)+"年")]),t._v(" "),e("div",{staticClass:"month-wrap"},[e("top-bar",{attrs:{data:t.barData},on:{barClick:t._barClick}})],1)]),t._v(" "),e("div",{staticClass:"tabs-wrap"},[e("div",{staticClass:"tabs-items",class:{active:0===t.tabsIndex},on:{click:function(a){return t._changeTabs(0)}}},[t._v("全量收入")]),t._v(" "),e("div",{staticClass:"tabs-items",class:{active:1===t.tabsIndex},on:{click:function(a){return t._changeTabs(1)}}},[t._v("销售收入")])]),t._v(" "),e("div",{staticClass:"title-wrap",domProps:{textContent:t._s(t._setTitle)}}),t._v(" "),e("div",{staticClass:"next-content-wrap"},[t.tabsIndex?e("v-table",{attrs:{tHeader:t.tHead,tBody:t.tBody,tFoot:t.tFoot,activeArr:t.activeArr,isLinkNumberMax:t.isLinkNumberMax},on:{trClick:t._trClick}}):e("v-table",{attrs:{tHeader:t.tHead,tBody:t.tBody,tFoot:t.tFoot}})],1),t._v(" "),e("van-popup",{attrs:{position:"bottom"},model:{value:t.show,callback:function(a){t.show=a},expression:"show"}},[e("van-picker",{attrs:{"show-toolbar":"",columns:t.columns},on:{cancel:t.onCancel,confirm:t.onConfirm}})],1),t._v(" "),e("transition",{attrs:{name:"slide"}},[e("router-view")],1)],1)},staticRenderFns:[]};var h=e("VU/8")(l,u,!1,function(t){e("bHah")},"data-v-bda9ca3c",null);a.default=h.exports},bHah:function(t,a){}});